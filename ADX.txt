N:=14;
M:=6;
MTR:=SUM(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(REF(CLOSE,1)-LOW)),N);
HD :=HIGH-REF(HIGH,1);
LD :=REF(LOW,1)-LOW;
DMP:=SUM(IF(HD>0&&HD>LD,HD,0),N);
DMM:=SUM(IF(LD>0&&LD>HD,LD,0),N);
VPDI:= DMP*100/MTR;
VMDI:= DMM*100/MTR;

DRAWBAND(VPDI,RGB(0,80,0),VMDI,RGB(0,0,0));

PDI: DMP*100/MTR,COLORBLUE;
MDI: DMM*100/MTR,COLORRED;